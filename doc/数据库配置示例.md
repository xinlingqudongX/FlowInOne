# MikroORM 数据库配置指南

## 安装依赖

```bash
# 安装 MikroORM 相关依赖
pnpm install @mikro-orm/core @mikro-orm/nestjs @mikro-orm/better-sqlite
```

## 配置 MikroORM

### 2. 修改 app.module.ts

```typescript
import { Module } from '@nestjs/common';
import { MikroOrmModule as MikroOrmNestModule } from '@mikro-orm/nestjs';
import config from './mikro-orm.config';
import { AppController } from './app.controller';
import { AppService } from './app.service';

@Module({
  imports: [
    MikroOrmNestModule.forRoot(config),
  ],
  controllers: [AppController],
  providers: [AppService],
})
export class AppModule {}
```

### 4. 在服务中使用 EntityManager

```typescript
import { Injectable } from '@nestjs/common';
import { InjectRepository } from '@mikro-orm/nestjs';
import { EntityRepository } from '@mikro-orm/core';
import { User } from '../entities/user.entity';

@Injectable()
export class UserService {
  constructor(
    @InjectRepository(User)
    private readonly userRepository: EntityRepository<User>,
  ) {}

  async findAll(): Promise<User[]> {
    return this.userRepository.findAll();
  }

  async create(user: Partial<User>): Promise<User> {
    const newUser = this.userRepository.create(user);
    await this.userRepository.persistAndFlush(newUser);
    return newUser;
  }
}
```